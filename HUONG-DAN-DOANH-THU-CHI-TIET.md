# ğŸ“Š HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG CHá»¨C NÄ‚NG XEM DOANH THU CHI TIáº¾T THEO USER

## ğŸ¯ Tá»•ng quan

Chá»©c nÄƒng má»›i nÃ y cho phÃ©p **Admin** xem chi tiáº¿t doanh thu theo tá»«ng ngÆ°á»i dÃ¹ng, bao gá»“m:
- Tá»•ng sá»‘ tiá»n má»—i user Ä‘Ã£ chi tiÃªu
- Danh sÃ¡ch cÃ¡c khÃ³a há»c mÃ  user Ä‘Ã£ mua
- GiÃ¡ cá»§a tá»«ng khÃ³a há»c
- NgÃ y mua vÃ  mÃ£ Ä‘Æ¡n hÃ ng

## ğŸš€ CÃ¡ch sá»­ dá»¥ng

### BÆ°á»›c 1: Truy cáº­p Admin Dashboard

1. ÄÄƒng nháº­p vá»›i tÃ i khoáº£n admin: `admin@ptit.edu.vn`
2. VÃ o trang **Admin Dashboard**
3. Chuyá»ƒn Ä‘áº¿n tab **"ğŸ“Š Thá»‘ng kÃª"**

### BÆ°á»›c 2: Xem chi tiáº¿t doanh thu theo user

1. Cuá»™n xuá»‘ng pháº§n **"Top 10 khÃ³a há»c doanh thu cao nháº¥t"**
2. Báº¡n sáº½ tháº¥y nÃºt **"Xem chi tiáº¿t doanh thu theo user"** á»Ÿ gÃ³c pháº£i trÃªn
3. Click vÃ o nÃºt nÃ y

### BÆ°á»›c 3: KhÃ¡m phÃ¡ thÃ´ng tin chi tiáº¿t

TrÃªn trang chi tiáº¿t, báº¡n sáº½ tháº¥y:

#### ğŸ“ˆ Thá»‘ng kÃª tá»•ng quan (á»Ÿ trÃªn cÃ¹ng):
- ğŸ’° **Tá»•ng doanh thu**: Tá»•ng sá»‘ tiá»n tá»« táº¥t cáº£ cÃ¡c Ä‘Æ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c duyá»‡t
- ğŸ‘¥ **Tá»•ng sá»‘ ngÆ°á»i dÃ¹ng**: Sá»‘ lÆ°á»£ng user Ä‘Ã£ mua khÃ³a há»c
- ğŸ“¦ **Tá»•ng sá»‘ Ä‘Æ¡n hÃ ng**: Tá»•ng sá»‘ Ä‘Æ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c thanh toÃ¡n

#### ğŸ‘¤ Chi tiáº¿t tá»«ng user (sáº¯p xáº¿p theo tá»•ng chi tiÃªu giáº£m dáº§n):

Má»—i card user hiá»ƒn thá»‹:
- **ThÃ´ng tin user**:
  - Há» tÃªn
  - Email
  - Sá»‘ Ä‘iá»‡n thoáº¡i (náº¿u cÃ³)
  
- **Thá»‘ng kÃª cá»§a user**:
  - ğŸ’° Tá»•ng chi tiÃªu
  - ğŸ“¦ Sá»‘ Ä‘Æ¡n hÃ ng
  - ğŸ“š Sá»‘ khÃ³a há»c Ä‘Ã£ mua

- **Báº£ng danh sÃ¡ch khÃ³a há»c Ä‘Ã£ mua**:
  - STT
  - TÃªn khÃ³a há»c
  - Danh má»¥c (Python, Finance, Data, Marketing, Blockchain, Accounting)
  - GiÃ¡ Ä‘Ã£ thanh toÃ¡n
  - NgÃ y mua
  - MÃ£ Ä‘Æ¡n hÃ ng

## ğŸ’¡ CÃ¡c tÃ­nh nÄƒng ná»•i báº­t

### 1. ğŸ¨ Giao diá»‡n Ä‘áº¹p máº¯t
- Card user vá»›i gradient mÃ u tÃ­m
- Badge mÃ u sáº¯c theo danh má»¥c khÃ³a há»c
- Hover effects mÆ°á»£t mÃ 
- Responsive trÃªn má»i thiáº¿t bá»‹

### 2. ğŸ“Š Sáº¯p xáº¿p thÃ´ng minh
- User Ä‘Æ°á»£c sáº¯p xáº¿p theo tá»•ng chi tiÃªu giáº£m dáº§n
- Dá»… dÃ ng xÃ¡c Ä‘á»‹nh "khÃ¡ch hÃ ng VIP"

### 3. ğŸ” ThÃ´ng tin chi tiáº¿t
- Xem Ä‘Æ°á»£c tá»«ng khÃ³a há»c user Ä‘Ã£ mua
- GiÃ¡ vÃ  ngÃ y mua cá»¥ thá»ƒ
- MÃ£ Ä‘Æ¡n hÃ ng Ä‘á»ƒ tra cá»©u

### 4. ğŸ“± Responsive Design
- Hiá»ƒn thá»‹ tá»‘t trÃªn desktop, tablet, mobile
- Báº£ng cÃ³ thá»ƒ scroll ngang trÃªn mÃ n hÃ¬nh nhá»

## ğŸ“ LÆ°u Ã½

- âœ… Chá»‰ hiá»ƒn thá»‹ cÃ¡c Ä‘Æ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c **duyá»‡t** (status = 'approved')
- âœ… Náº¿u chÆ°a cÃ³ user nÃ o mua khÃ³a há»c, sáº½ hiá»ƒn thá»‹ thÃ´ng bÃ¡o "ChÆ°a cÃ³ dá»¯ liá»‡u"
- âœ… CÃ³ nÃºt **"Quay láº¡i Dashboard"** Ä‘á»ƒ quay vá» trang quáº£n trá»‹

## ğŸ¯ Use Cases

### 1. PhÃ¢n tÃ­ch khÃ¡ch hÃ ng
- XÃ¡c Ä‘á»‹nh top khÃ¡ch hÃ ng chi tiÃªu nhiá»u nháº¥t
- Hiá»ƒu Ä‘Æ°á»£c sá»Ÿ thÃ­ch cá»§a tá»«ng user
- Láº­p chiáº¿n lÆ°á»£c marketing phÃ¹ há»£p

### 2. BÃ¡o cÃ¡o doanh thu
- Xuáº¥t bÃ¡o cÃ¡o chi tiáº¿t cho ban giÃ¡m Ä‘á»‘c
- PhÃ¢n tÃ­ch xu hÆ°á»›ng mua hÃ ng
- ÄÃ¡nh giÃ¡ hiá»‡u quáº£ cÃ¡c chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i

### 3. ChÄƒm sÃ³c khÃ¡ch hÃ ng
- Nháº­n diá»‡n khÃ¡ch hÃ ng VIP Ä‘á»ƒ cÃ³ chÃ­nh sÃ¡ch Æ°u Ä‘Ã£i
- Theo dÃµi lá»‹ch sá»­ giao dá»‹ch
- Giáº£i quyáº¿t khiáº¿u náº¡i nhanh chÃ³ng

## ğŸ”§ ThÃ´ng tin ká»¹ thuáº­t

### Files Ä‘Æ°á»£c táº¡o:

1. **UserRevenueServlet.java**
   - Path: `src/main/java/com/example/servlets/UserRevenueServlet.java`
   - Xá»­ lÃ½ logic láº¥y dá»¯ liá»‡u tá»« database
   - TÃ­nh toÃ¡n thá»‘ng kÃª tá»•ng quan

2. **user-revenue-detail.jsp**
   - Path: `src/main/webapp/user-revenue-detail.jsp`
   - Hiá»ƒn thá»‹ giao diá»‡n chi tiáº¿t doanh thu
   - Responsive design vá»›i CSS inline

3. **Sá»­a Ä‘á»•i admin-dashboard.jsp**
   - ThÃªm nÃºt "Xem chi tiáº¿t doanh thu theo user"
   - á» pháº§n thá»‘ng kÃª top 10 khÃ³a há»c

### URL:
```
http://localhost:8080/admin/user-revenue
```

### SQL Query chÃ­nh:
```sql
SELECT 
    u.user_id, 
    u.email, 
    u.fullname, 
    u.phone, 
    COUNT(DISTINCT o.order_id) as order_count, 
    SUM(o.total_amount) as total_spent, 
    MAX(o.created_at) as last_purchase 
FROM users u 
INNER JOIN orders o ON u.user_id = o.user_id 
WHERE o.status = 'approved' 
GROUP BY u.user_id, u.email, u.fullname, u.phone 
ORDER BY total_spent DESC
```

## ğŸ‰ Káº¿t luáº­n

Chá»©c nÄƒng má»›i nÃ y giÃºp Admin cÃ³ cÃ¡i nhÃ¬n toÃ n diá»‡n vá» doanh thu tá»«ng user, tá»« Ä‘Ã³ Ä‘Æ°a ra cÃ¡c quyáº¿t Ä‘á»‹nh kinh doanh chÃ­nh xÃ¡c hÆ¡n. Giao diá»‡n Ä‘áº¹p máº¯t, dá»… sá»­ dá»¥ng vÃ  Ä‘áº§y Ä‘á»§ thÃ´ng tin cáº§n thiáº¿t!

---

**ChÃºc báº¡n sá»­ dá»¥ng hiá»‡u quáº£! ğŸš€**
